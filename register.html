<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image:src" content="">
  <meta property="og:image" content="">
  <meta name="twitter:title" content="Cadastro - Astral Legacy">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/512xnewhypixel.png" type="image/x-icon">
  <meta name="description" content="Crie sua conta no servidor de Minecraft Astral Legacy">
  
  <title>Cadastro - Astral Legacy</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons2/mobirise2.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/parallax/jarallax.css">
  <link rel="stylesheet" href="assets/animatecss/animate.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/socicon/css/styles.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Fredoka+One:400&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fredoka+One:400&display=swap"></noscript>
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
  
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
  
  <section data-bs-version="5.1" class="menu menu2 cid-tkbL8n4vab" once="menu" id="menu2-16">
    <nav class="navbar navbar-dropdown navbar-fixed-top navbar-expand-lg">
        <div class="container-fluid">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.html">
                        <img src="assets/images/512xnewhypixel.png" alt="" style="height: 3rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-7" href="index.html">Astral Legacy</a></span>
            </div>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true">
                    <li class="nav-item"><a class="nav-link link text-white text-primary display-4" href="index.html#features13-2">O que é Astral Legacy</a></li>
                    <li class="nav-item"><a class="nav-link link text-white text-primary display-4" href="como-entrar.html">Como entrar</a></li>
                    <li class="nav-item"><a class="nav-link link text-white text-primary display-4" href="rules.html">Regras</a></li>
                </ul>
                
                <div class="navbar-buttons mbr-section-btn">
                    <a class="btn btn-primary display-4" href="shop.html"><span class="mobi-mbri mobi-mbri-shopping-basket mbr-iconfont mbr-iconfont-btn"></span>Loja</a>
                    <a class="btn btn-secondary display-4" href="auth.html" id="auth-btn"><span class="mobi-mbri mobi-mbri-login mbr-iconfont mbr-iconfont-btn"></span>Entrar</a>
                </div>
            </div>
        </div>
    </nav>
</section>

<section data-bs-version="5.1" class="header14 cid-tjqsbNJ1Xp mbr-fullscreen mbr-parallax-background" id="header14-e">
    <div class="mbr-overlay" style="opacity: 0.8; background-color: rgb(1, 17, 26);"></div>

    <div class="container">
        <div class="row justify-content-center align-items-center">
            <div class="col-12 col-md-6 image-wrapper">
                <img src="assets/images/512xnewhypixel.png" alt="">
            </div>
            <div class="col-12 col-md">
                <div class="text-wrapper">
                    <h1 class="mbr-section-title mbr-fonts-style mb-3 display-1"><strong>Criar Conta</strong></h1>
                    <p class="mbr-text mbr-fonts-style display-7">
                        Registre-se para acessar benefícios exclusivos do Astral Legacy!</p>
                </div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="content14 cid-register-form" id="register-form">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="card">
                    <div class="card-body p-4">
                        <h3 class="mbr-section-title mbr-fonts-style mb-4 display-2 text-center">
                            <strong>Registrar</strong>
                        </h3>
                        <form id="registerForm">
                            <div class="form-group mb-3">
                                <label class="form-control-label">Nickname no Servidor</label>
                                <input type="text" class="form-control" id="registerNickname" required>
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-control-label">Email</label>
                                <input type="email" class="form-control" id="registerEmail" required>
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-control-label">Senha</label>
                                <input type="password" class="form-control" id="registerPassword" required minlength="6">
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-control-label">Confirmar Senha</label>
                                <input type="password" class="form-control" id="confirmPassword" required>
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-control-label">Número de Celular</label>
                                <input type="tel" class="form-control" id="registerPhone">
                            </div>
                            <div class="mbr-section-btn text-center">
                                <button type="submit" class="btn btn-primary display-4">Registrar</button>
                            </div>
                        </form>
                        <div class="text-center mt-3">
                            <p>Já tem uma conta? <a href="auth.html">Entre aqui</a></p>
                        </div>
                    </div>
                </div>

                <!-- Mensagens de erro/sucesso -->
                <div id="message" class="alert" style="display: none; margin-top: 20px;"></div>
            </div>
        </div>
    </div>
</section>

<section data-bs-version="5.1" class="footer1 cid-tkbGMWG3Nn" once="footer" id="footer01-15">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-6 my-auto px-4 align-left">
                <p class="mbr-text text-grey mb-0 mbr-fonts-style display-7">
                    © Copyright 2022 <strong>Astral Legacy</strong>. Todos os direitos reservados.<br><a href="imprint.html" class="text-primary" target="_blank">Impressum </a>| <a href="privacy.html" class="text-primary" target="_blank">Privacidade </a>| <a href="tos.html" class="text-primary" target="_blank">Termos de Serviço</a></p>
            </div>
            <div class="col-md-12 col-lg-6 px-4 align-right">
                <div class="social-list">
                    <div class="soc-item">
                        <a href="https://youtube.com" target="_blank">
                            <span class="mbr-iconfont mbr-iconfont-social socicon-youtube socicon"></span>
                        </a>
                    </div>
                    <div class="soc-item">
                        <a href="https://discord.com" target="_blank">
                            <span class="mbr-iconfont mbr-iconfont-social socicon-discord socicon"></span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<style>
.card {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    border: none;
}

.form-control {
    border-radius: 8px;
    border: 2px solid #e0e0e0;
    padding: 12px 15px;
    transition: all 0.3s ease;
}

.form-control:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

.btn {
    border-radius: 8px;
    padding: 12px 30px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.alert {
    border-radius: 8px;
    border: none;
    padding: 15px 20px;
}

.alert-success {
    background-color: #d4edda;
    color: #155724;
}

.alert-danger {
    background-color: #f8d7da;
    color: #721c24;
}
</style>

<script>
// Configuração do Supabase
const supabaseUrl = 'YOUR_SUPABASE_URL';
const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';
const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);

// Função para mostrar mensagens
function showMessage(message, type = 'success') {
    const messageDiv = document.getElementById('message');
    messageDiv.className = `alert alert-${type}`;
    messageDiv.textContent = message;
    messageDiv.style.display = 'block';
    setTimeout(() => messageDiv.style.display = 'none', 5000);
}

// Registro
document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const nickname = document.getElementById('registerNickname').value;
    const email = document.getElementById('registerEmail').value;
    const password = document.getElementById('registerPassword').value;
    const confirmPassword = document.getElementById('confirmPassword').value;
    const phone = document.getElementById('registerPhone').value;

    if (password !== confirmPassword) {
        showMessage('As senhas não coincidem!', 'danger');
        return;
    }

    try {
        // Criar usuário no Auth com metadados
        const { data, error } = await supabase.auth.signUp({
            email,
            password,
            options: {
                data: {
                    nickname: nickname,
                    phone: phone
                }
            }
        });

        if (error) throw error;

        // Verificar se o usuário foi criado
        if (!data.user) {
            showMessage('Este e-mail já está cadastrado!', 'danger');
            return;
        }

        // Verificar se o email já existe mas não foi confirmado
        if (data.user && data.user.identities && data.user.identities.length === 0) {
            showMessage('Este e-mail já está cadastrado. Verifique sua caixa de entrada para confirmar.', 'warning');
            return;
        }

        // Sucesso no cadastro
        showMessage('Conta criada com sucesso! Você já pode fazer login.', 'success');
        setTimeout(() => window.location.href = 'auth.html', 3000);

    } catch (err) {
        console.error('Erro detalhado:', err);
        showMessage('Erro no cadastro: ' + err.message, 'danger');
    }
});
</script>

<script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="assets/parallax/jarallax.js"></script>
<script src="assets/smoothscroll/smooth-scroll.js"></script>
<script src="assets/ytplayer/index.js"></script>
<script src="assets/dropdown/js/navbar-dropdown.js"></script>
<script src="assets/theme/js/script.js"></script>

<input name="animation" type="hidden">
</body>
</html>